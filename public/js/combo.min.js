var app=angular.module("myApp",[]);app.controller("itemController",function(a,b){a.showConfirm=!1,a.showInvalid=!1,a.openItem=!0,a.cartItems=[],a.noCart=!0,a.purchased=!1,a.total=0,a.name="",a.email="",a.password="",a.toggle=function(){a.openItem=!a.openItem},a.findIndex=function(b,c){for(var d in a[c])if(a[c][d].id==b)return d;return-1},a.calculateTotal=function(){a.total=0,$.each(a.cartItems,function(b,c){a.total+=c.price*c.qty})},a.close=function(){a.showConfirm=!a.showConfirm,a.purchased&&(a.cartItems.length=0,a.openItem=!0,a.noCart=!0,a.purchased=!1,$.each(a.items,function(a,b){b.inCart=!1,b.qty=1}))},a.incItemQty=function(b){var c=a.findIndex(b,"cartItems");a.cartItems[c].qty+=1,a.calculateTotal()},a.decItemQty=function(b){var c=a.findIndex(b,"cartItems");a.cartItems[c].qty>1&&(a.cartItems[c].qty-=1),a.calculateTotal()},a.addToCart=function(b){var c=a.findIndex(b,"cartItems");-1==c?(c=a.findIndex(b,"items"),a.items[c].inCart=!0,a.cartItems.push(a.items[c]),a.noCart=!1):a.cartItems[c].qty+=1,a.calculateTotal()},a.removeFromCart=function(b){var c=a.findIndex(b,"items");a.items[c].inCart=!1,a.items[c].qty=1,c=a.findIndex(b,"cartItems"),a.cartItems.splice(c,1),0==a.cartItems.length&&(a.noCart=!0,a.openItem=!0),a.calculateTotal()},a.checkout=function(){a.showConfirm=!0},a.showMatchResult=function(){a.showInvalid=!1,a.purchased=!0},a.showNoMatchResult=function(){a.showInvalid=!0},a.submit=function(){b.get("../data/users.json").success(function(b){var c=-1;$.each(b.users,function(b,d){d.email===a.email&&d.password===a.password&&(c=b,a.name=d.name)}),-1!=c?a.showMatchResult():a.showNoMatchResult()}).error(function(){})},b.get("../data/items.json").success(function(b){a.items=b.items}).error(function(){})});